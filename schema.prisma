datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["nApi"]
}

model Customer {
  id      String   @id @default(cuid())
  name    String
  users   User[]
  devices Device[]
  invites Invite[]
}

model User {
  id         String    @id @default(cuid())
  email      String    @unique
  password   String
  type       UserType  @default(USER)
  customerId String?
  customer   Customer? @relation(fields: [customerId], references: [id])
}

enum UserType {
  USER
  ADMIN
}

model Invite {
  id         String   @id @default(cuid())
  email      String   @unique
  customerId String
  customer   Customer @relation(fields: [customerId], references: [id])
  createdAt  DateTime @default(now())
}

model Device {
  id           String        @id @default(cuid())
  model        String
  brand        String
  image        String
  type         DeviceType    @default(STATIC)
  customerId   String
  customer     Customer      @relation(fields: [customerId], references: [id])
  interactions Interaction[]
  manuals      Manual[]
}

enum DeviceType {
  STATIC
  DYNAMIC
}

model Interaction {
  id          String          @id @default(cuid())
  type        InteractionType
  x           Float
  y           Float
  width       Float
  height      Float
  rotation    Float
  title       String
  description String
  deviceId    String
  device      Device          @relation(fields: [deviceId], references: [id])
  steps       ManualStep[]
}

enum InteractionType {
  SQUARE
  CIRCLE
  ANCHOR
}

model Manual {
  id       String       @id @default(cuid())
  title    String
  steps    ManualStep[]
  deviceId String
  device   Device       @relation(fields: [deviceId], references: [id])
}

model ManualStep {
  id           String        @id @default(cuid())
  text         String
  order        Int           @default(0)
  manualId     String
  manual       Manual        @relation(fields: [manualId], references: [id])
  interactions Interaction[]
}

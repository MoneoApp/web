datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id       String   @id @default(cuid())
  email    String   @unique
  password String
  role     UserRole @default(USER)
  devices  Device[]
}

enum UserRole {
  USER
  ADMIN
}

model Invite {
  id        String   @id @default(cuid())
  email     String   @unique
  createdAt DateTime @default(now())
}

model Device {
  id           String        @id @default(cuid())
  model        String
  brand        String
  image        String
  type         DeviceType    @default(STATIC)
  userId       String
  user         User          @relation(fields: [userId], references: [id])
  interactions Interaction[]
  manuals      Manual[]
}

enum DeviceType {
  STATIC
  DYNAMIC
}

model Interaction {
  id          String          @id @default(cuid())
  type        InteractionType
  x           Float
  y           Float
  width       Float
  height      Float
  rotation    Float
  title       String
  description String
  deviceId    String
  device      Device          @relation(fields: [deviceId], references: [id])
  steps       ManualStep[]
}

enum InteractionType {
  SQUARE
  CIRCLE
  ANCHOR
}

model Manual {
  id       String       @id @default(cuid())
  title    String
  steps    ManualStep[]
  deviceId String
  device   Device       @relation(fields: [deviceId], references: [id])
}

model ManualStep {
  id           String        @id @default(cuid())
  text         String
  order        Int           @default(0)
  manualId     String
  manual       Manual        @relation(fields: [manualId], references: [id])
  interactions Interaction[]
}
